# ============================================
# SERVER CONFIGURATION
# ============================================
NODE_ENV=development
PORT=5000
API_BASE_PATH=/api

# ============================================
# DATABASE CONFIGURATION
# ============================================
# MongoDB Connection String
MONGODB_URI=mongodb://localhost:27017/mern-auth-v4

# MongoDB Pool Settings
# Development: 10, Production: 50
MONGODB_POOL_SIZE=10

# MongoDB Timeout (seconds)
MONGODB_CONNECTION_TIMEOUT=30

# Auto-index: enabled (development), disabled (production)
MONGODB_AUTO_INDEX=true

# ============================================
# REDIS CONFIGURATION
# ============================================
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# Redis Session TTL (7 days in seconds)
REDIS_SESSION_TTL=604800

# ============================================
# JWT CONFIGURATION
# ============================================
# Secret keys - CHANGE THESE IN PRODUCTION
JWT_ACCESS_SECRET=your-super-secret-access-key-change-in-production
JWT_REFRESH_SECRET=your-super-secret-refresh-key-change-in-production

# Token expiration times
JWT_ACCESS_EXPIRES_IN=15m
JWT_REFRESH_EXPIRES_IN=7d

# Cookie settings
COOKIE_MAX_AGE=604800000
COOKIE_SECURE=false
COOKIE_SAME_SITE=lax

# ============================================
# FRONTEND CONFIGURATION
# ============================================
FRONTEND_URL=http://localhost:5173

# ============================================
# CORS CONFIGURATION
# ============================================
CORS_ORIGIN=http://localhost:5173
CORS_CREDENTIALS=true

# ============================================
# EMAIL CONFIGURATION (Nodemailer)
# ============================================
EMAIL_HOST=smtp.gmail.com
EMAIL_PORT=587
EMAIL_SECURE=false
EMAIL_USER=your-email@gmail.com
EMAIL_PASSWORD=your-app-password
EMAIL_FROM=MERN Auth <noreply@mernauth.com>

# ---------------------------------
# Email Service (Resend)
# ---------------------------------
RESEND_API_KEY=re_2xksRth5_7QPjhTKk2UHB6uDFJho7vULV
RESEND_FROM_EMAIL=noreply@shtlab.ca
RESEND_FROM_NAME=MERN Auth

# Email Token TTL
EMAIL_VERIFICATION_TTL=86400
PASSWORD_RESET_TTL=900

# ============================================
# RATE LIMITING CONFIGURATION
# ============================================
# General API rate limit (requests per window)
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# Auth endpoints rate limit
AUTH_RATE_LIMIT_WINDOW_MS=900000
AUTH_RATE_LIMIT_MAX_REQUESTS=5

LOGIN_RATE_LIMIT_WINDOW_MS=900000
LOGIN_RATE_LIMIT_MAX_ATTEMPTS=5
LOGIN_ATTEMPT_TTL=900

# Password reset
PASSWORD_RESET_RATE_LIMIT_WINDOW_MS=3600000
PASSWORD_RESET_RATE_LIMIT_MAX_REQUESTS=3

# ============================================
# SECURITY CONFIGURATION
# ============================================
# bcrypt password hashing rounds
BCRYPT_ROUNDS=10

# CSRF token length (bytes)
CSRF_TOKEN_LENGTH=32
# CSRF token TTL in seconds (Redis-backed). Defaults to cookie max age when unset.
CSRF_TOKEN_TTL=604800
# Rotate CSRF token on every verification (set to false to rotate only manually)
CSRF_ROTATE_ON_VERIFY=true
# Max CSRF failures per IP before blocking for the TTL window
CSRF_FAILURE_THRESHOLD=10

# Session ID length (bytes)
SESSION_ID_LENGTH=32

# ============================================
# FILE UPLOAD CONFIGURATION
# ============================================
# Max avatar file size (5MB in bytes)
MAX_AVATAR_SIZE=5242880

# Allowed image formats (comma-separated)
ALLOWED_IMAGE_FORMATS=jpg,jpeg,png,webp

# Image processing output size (pixels)
IMAGE_OUTPUT_SIZE=500

# Upload directory
UPLOAD_DIR=./uploads

# ============================================
# INTERNATIONALIZATION (i18n)
# ============================================
# Supported languages (comma-separated)
SUPPORTED_LANGUAGES=en,fr
DEFAULT_LANGUAGE=en

# ============================================
# LOGGING CONFIGURATION
# ============================================
LOG_LEVEL=info
LOG_FORMAT=combined

# ============================================
# OAUTH CONFIGURATION (Optional)
# ============================================
# Google OAuth
GOOGLE_CLIENT_ID=your-google-client-id
GOOGLE_CLIENT_SECRET=your-google-client-secret
GOOGLE_CALLBACK_URL=http://localhost:5000/api/auth/google/callback

# ============================================
# TWO-FACTOR AUTHENTICATION (2FA)
# ============================================
TWO_FACTOR_APP_NAME=MERN Auth v4
TWO_FACTOR_ISSUER=mernauth.com
# TTL (seconds) for pending 2FA secrets stored in Redis
TWO_FACTOR_TEMP_SECRET_TTL=600

# ============================================
# CACHE CONFIGURATION
# ============================================
# Cache TTL (1 hour in seconds)
CACHE_TTL=3600
